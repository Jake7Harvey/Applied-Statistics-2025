---
title: "Mod 0: Hypothesis Testing"
author: "Jake Harvey"
date: "2025-02-04"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(kableExtra)
library(lubridate)
library(ggplot2)
```

#NYC Crimes 2024

##1.
```{r}
df = read.csv("C:\\Users\\jphar\\OneDrive\\Documents\\APPLIED-STATISTICS\\NYPD_Arrest_Data__Year_to_Date_.csv")
head(df)
```
##2.
I am using the age range for the qualitative portion. The only issue I have with the age is that it is stored in a range, <18, 18-24, 25-44, 45-64, and 65+. This means that the age range, although they are numbers, are stored as a <chr> data type. It also means that if I covert them to the midpoint of the range that the data will not have that many variables, and would more than likely cause the mean to be somewhere between 25-44. I am going to do three different things for each problem. The first is just run it as it is with the data I am given. The second is to take the midpoint of the ranges. The third is to use a random number generator to pick a number between these age ranges and use it.

Age Range Counter
```{r Age Range Counter}
Age_Range <- df |>
  filter(!is.na(AGE_GROUP)) |>
  group_by(AGE_GROUP) |>
  summarise(Age_Range = n())
print(Age_Range)
```

Random Number Generator
```{r Random Age Generator}
Generate_Random_Age <- function(Age_Range) {
  case_when(
    Age_Range == '<18' ~ sample(15:17, 1),
    Age_Range == '18-24' ~ sample(18:24, 1),
    Age_Range == '25-44' ~ sample(25:44, 1),
    Age_Range == '45-64' ~ sample(45:64, 1),
    Age_Range == '65+' ~ sample(65:75, 1)
  )
}
Random_Ages <- df |>
  mutate(Random_Ages = sapply(AGE_GROUP, Generate_Random_Age))
```

#A. 
#Mean
As is
```{r}
Age_Range_List <- c(43174, 152034, 51121, 4649, 9525)

result.mean <- mean(Age_Range_List)
print(result.mean)
```
Midpoint
```{r}
age_ranges <- data.frame(
  AGE_GROUP = c('<18', '18-24', '25-44', '45-64', '65+'),
  Midpoint = c(16, 21, 35, 55, 70)
)

Age_Range <- df |>
  filter(!is.na(AGE_GROUP)) |>
  group_by(AGE_GROUP) |>
  summarise(Age_Range = n())

Age_Range <- Age_Range |>
  left_join(age_ranges, by = "AGE_GROUP")

weighted_midpoints <- sum(Age_Range$Age_Range * Age_Range$Midpoint)

total_count <- sum(Age_Range$Age_Range)

result.mean <- weighted_midpoints / total_count
print(result.mean)
```
Random Ages
```{r}
result.mean <- mean(df$Random_Ages, na.rm = TRUE)
print(result.mean)
```
#Standard Deviation
As is
```{r}
SD<-sqrt(sum((Age_Range_List-mean(Age_Range_List))^2/(length(Age_Range_List)-1)))
 
print(SD)
```
Midpoint
```{r}
SD <- sd(Age_Range$Midpoint, na.rm = FALSE)

print(SD)
```
Random Ages
```{r}
SD<-sd(df$Random_Ages, na.rm = FALSE)

print(SD)
```


As is
```{r}

```


